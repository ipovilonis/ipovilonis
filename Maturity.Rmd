---
title: "Maturity"
output:
 html_document:
   toc: true
   toc_depth: 5
   toc_float:
     collapsed: false
     smooth_scroll: true
---

The aim of this work was to study the evolution of fruit size and weight together with the
soluble solid and total titratable acidity contents with the patterns of accumulation of chlorophylls, carotenoids, phenols and antioxidant activity during ripening of *Hexachlamys edulis* fruits, to understand the optimal time and conditions needed to obtain maximum nutraceutical characteristics. Fruits were harvested from H. edulis plants growing at the experimental field of the University of Morón (Moreno, Buenos Aires, 34°35'4.98" SL, 58°48'52.09" WL, 14 m.a.s.l.).

```{r pressure, echo=FALSE, fig.cap="A caption", out.width = '100%'}
knitr::include_graphics("IMG_mat.jpg")
```

# Variables físicas

## Peso fresco del fruto (PFF)

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
setwd("C:/Users/um/Documents/ipovilonis/Doc/6 - Producción/web/ipovilonis.github.io")
data<-read.delim("madurez.txt")
data$MADUREZ<-as.factor(data$MADUREZ)
data$MADUREZ<-factor(data$MADUREZ,levels=c("Inmaduro", "Medio Maduro", "Maduro", "SobreMaduro"))

```

### Tabla descriptiva
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estad <- summarySE(data, measurevar="PFF", groupvars=c("MADUREZ"))
estad

```

### Gráfico con desvío estándar
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(ggplot2)
ggplot(estad, aes(x=MADUREZ, y=PFF, color=MADUREZ)) +
  scale_color_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  stat_summary(fun = "mean", size = 6, geom = "point") +
  geom_errorbar(aes(ymin=PFF-sd, ymax=PFF+sd),
                width=.2, position=position_dodge(.9)) +  
  ylab("PFF")+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )+
  ylim(0,80)

```

### Boxplot
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

graf1<- ggplot(data, aes(MADUREZ, PFF, fill=MADUREZ)) +  
  geom_boxplot()+labs(y="PFF")+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )+
  ylim(0,80)
graf1

```

### Relacion media-varianza
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

estad$var=estad$sd^2#agrego varianza
vs<-ggplot(estad, aes(x=PFF, y=var))+geom_point(size=4) +   
  geom_smooth(method="lm", se = FALSE, color="red", linetype="dashed") + xlab("Media") +
  ylab("Varianza") +  ggtitle("Relaci?n media - varianza")+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )
vs

```

### Modelos

* M0: modelo sólo con el factor fijo madurez.
* M1: M0 + modelado de la varinza por varIdent
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

M0<- lm(PFF ~ MADUREZ ,data)

library(nlme)
M1 <- gls(PFF ~ MADUREZ, weights=varIdent(form=~1|MADUREZ), data = data)

```

### Eleccción de modelos por AIC
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

AIC(M0, M1)

```
Se elije el modelo M1

### Verificación de supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

e<-resid(M1) # residuos
rest <- resid(M1, type="normalized") #residuos estandarizados
pre<-predict(M1) #predichos

par(mfrow = c(1, 2))
plot(pre, rest, xlab="Predichos", ylab="Residuos estandarizados",main="Gráfico de dispersión de RE vs PRED" )
abline(0,0)
qqnorm(e)
qqline(e)
shapiro.test(e)
par(mfrow = c(1, 1))
library(car)
leveneTest(PFF~MADUREZ, data, center=mean)

```

### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(M1)

```

### Comparaciones a posteriori
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Comp2<-emmeans(M0, pairwise ~ MADUREZ) #Tukey por default  
Comp2
plot(Comp2, comparisons = TRUE) + theme_classic() + 
  labs(x = "Peso (g)", y ="Madurez" )

```

## Peso seco de fruto (PSF)

### Tabla descriptiva
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estad <- summarySE(data, measurevar="PSF", groupvars=c("MADUREZ"))
estad

```

### Gráfico con desvío estándar
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(ggplot2)
ggplot(estad, aes(x=MADUREZ, y=PSF, color=MADUREZ)) +
  scale_color_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  stat_summary(fun = "mean", size = 6, geom = "point") +
  geom_errorbar(aes(ymin=PSF-sd, ymax=PSF+sd),
  width=.2,                    # Width of the error bars
  position=position_dodge(.9)) +  
  ylab("PSF")+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )+
  ylim(0,13)

```

### Boxplot
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

graf2<- ggplot(data, aes(MADUREZ, PSF, fill=MADUREZ)) +  
  geom_boxplot()+labs(y="PSF")+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )+
  ylim(0,13)
graf2

```

### Relacion media-varianza
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

estad$var=estad$sd^2#agrego varianza
vs<-ggplot(estad, aes(x=PSF, y=var))+geom_point(size=4) +   
  geom_smooth(method="lm", se = FALSE, color="red", linetype="dashed") + xlab("Media") +
  ylab("Varianza") +  ggtitle("Relaci?n media - varianza")+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )
vs

```

### Modelos

* M0s: modelo sólo con el factor fijo madurez.
* M1s: M0 + modelado de la varinza por varIdent
* M1si: M1 con variable respuesta inversa (1/Y)
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
# MODELOS
M0s<- lm(PSF ~ MADUREZ ,data)
library(nlme)
M1s <- gls(PSF ~ MADUREZ, weights=varIdent(form=~1|MADUREZ), data = data)
M1si <- gls(1/PSF ~ MADUREZ, weights=varIdent(form=~1|MADUREZ), data = data)

```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

AIC(M0s, M1s, M1si)

```

Se elije el modelo M1si

### Verificación de supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

e<-resid(M1si) # residuos
rest <- resid(M1si, type="normalized") #residuos estandarizados
pre<-predict(M1si) #predichos

par(mfrow = c(1, 2))
plot(pre, rest, xlab="Predichos", ylab="Residuos estandarizados",main="Gráfico de dispersión de RE vs PRED" )
abline(0,0)
qqnorm(e)
qqline(e)
shapiro.test(e)
par(mfrow = c(1, 1))
library(car)
leveneTest(PSF~MADUREZ, data, center=mean)

```

### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(M1si)

```

### Comparaciones a posteriori
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Comp2<-emmeans(M1si, pairwise ~ MADUREZ) #Tukey por default  
Comp2
plot(Comp2, comparisons = TRUE)

```

## Humedad

### Tabla descriptiva
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estadH <- summarySE(data, measurevar="H", groupvars=c("MADUREZ"))
estadH

```

### Gráfico con desvío estándar
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(ggplot2)
ggplot(estadH, aes(x=MADUREZ, y=H, color=MADUREZ)) +
  scale_color_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  stat_summary(fun = "mean", size = 6, geom = "point") +
  geom_errorbar(aes(ymin=H-sd, ymax=H+sd),
  width=.2,                    # Width of the error bars
  position=position_dodge(.9)) +  
  ylab("Humidity (/100)")+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )+
  ylim(0.5,1)

```

### Boxplot
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

graf2<- ggplot(data, aes(MADUREZ, H, fill=MADUREZ)) +  
  geom_boxplot()+labs(y="Humiity")+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )+
  ylim(0.5,1)
graf2

```

### Relacion media-varianza
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

# estadH$var=estadH$sd^2#agrego varianza
# vs<-ggplot(estadH, aes(x=H, y=var))+geom_point(size=4) +   
#   geom_smooth(method="lm", se = FALSE, color="red", linetype="dashed") + xlab("Media") +
#   ylab("Varianza") +  ggtitle("Relación media - varianza")+
#   theme_classic()+
#   theme(legend.title=element_blank())+
#   theme(legend.position = "none" )
# vs

```

### Modelos

* M0s: modelo sólo con el factor fijo madurez.
* M1s: M0 + modelado de la varinza por varIdent
* M1si: M1 con variable respuesta inversa (1/Y)
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
# MODELOS
M0sH<- lm(H ~ MADUREZ ,data)
M0sH
```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

# AIC(M0s, M1s, M1si)

```

Se elije el modelo M0sH

### Verificación de supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

e<-resid(M0sH) # residuos
rest <- resid(M0sH, type="response") #residuos estandarizados
pre<-predict(M0sH) #predichos

par(mfrow = c(1, 2))
plot(pre, rest, xlab="Predichos", ylab="Residuos estandarizados",main="Gráfico de dispersión de RE vs PRED" )
abline(0,0)
qqnorm(e)
qqline(e)
shapiro.test(e)
par(mfrow = c(1, 1))
library(car)
leveneTest(H~MADUREZ, data, center=mean)

```

### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(M0sH)

```

### Comparaciones a posteriori
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
emm_options(opt.digits = FALSE)
Comp2H<-emmeans(M0sH, pairwise ~ MADUREZ) #Tukey por default  
Comp2H
plot(Comp2H, comparisons = TRUE)

```

## Diámetro

## Peso seco semilla

## Tabla resumen
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
setwd("C:/Users/um/Documents/ipovilonis/Doc/6 - Producción/web/ipovilonis.github.io")
library(png)
library(grid)
img <- readPNG("varfis.png")
 grid.raster(img)
```

ANOVA for the fresh fruit weight (FFW). dry fruit weight (DFW). dry fruit weight as percentage of fresh fruit weight (DFW%). maximum equatorial fruit diameter (MAEFD). minimum equatorial fruit diameter (MIEFD). polar fruit diameter (PFD). seed number (SN). dry seed weight (DSW) and dry seed weight/dry fruit weight ratio (DSW/DFW) considering the fruit ripening of H. edulis "ubajay" harvested from the plants growing in the experimental field of the University of Morón in Moreno (Buenos Aires) during December 2018.

## Colorimetría

# Variables químicas

The objective of this second part is to study the organic acids, carbohydrates and cations in the different stages of maturity.

## Carotenoides

## Clorofilas

## Fenoles

## Actividad anti oxidante (DPPH)

### Tabla descriptiva
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
setwd("C:/Users/um/Documents/ipovilonis/Doc/6 - Producción/web/ipovilonis.github.io")
Datos0 <- read.delim("AA_r0.txt")
Datos0$Muestra<-factor(Datos0$Muestra)
Datos0$Conc<-factor(Datos0$Conc)
Datos0$Trata<-factor(Datos0$Trata,levels=c("I","MM", "M","SM"))

library(psych)
describeBy(Datos0$In,Datos0$Trata)

```

### Boxplot de capacidad anti oxidante para distintos grados de madurez
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(ggplot2)
colores<-c("palegreen4","green2","orange2","burlywood2")
box <- ggplot(Datos0, aes(x=Datos0$Trata, y=Datos0$In, fill=Trata)) +
  geom_boxplot(aes())+
  theme_classic()+
  geom_jitter(alpha=0.6, size=6,aes(color=Conc), position = position_jitter(width = .05))+
  scale_fill_manual(values = colores)+
  scale_color_manual(values = c("cyan4", "coral1","green3","yellow3"))+
  theme(legend.position="bottom", legend.text=element_text(size = 10),
        legend.title = element_text(size=16, face="bold")) +
  ylab("% Inh")+xlab("Maturity")
box

```

### Modelo
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(lme4)
maoo<-lmer(In~Trata + (1|Conc), data=Datos0)
maoo

```

### Supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

e<-resid(maoo) # residuos de pearson
pre<-predict(maoo) #predichos
par(mfrow = c(1, 2))
plot(pre, e, xlab="Predichos", ylab="Residuos de pearson",main="Gráfico de dispersión de Residuos vs Predichos",cex.main=.8 )
abline(0,0)
qqnorm(e)
qqline(e)
shapiro.test(e)

```

### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(car)
Anova(maoo)

```

### Comparaciones a posteriori
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
Comp2<-emmeans(maoo, pairwise ~ Trata) #Tukey por default  
Comp2
plot(Comp2, comparisons = TRUE) + theme_classic() + 
  labs(x = "Capacidad anti oxidante (%)", y ="Madurez" )

```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)


```

### Evolución de la Avtividad anti oxidante en la maduración
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=15, fig.height=10}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
setwd("C:/Users/um/Documents/ipovilonis/Doc/6 - Producción/web/ipovilonis.github.io")
data<-read.delim("tablaAAO.txt")
data$T<-as.factor(data$T)
data$T<-factor(data$T,levels=c("Unripe", "Medium ripe","Ripe", "Overripe"))
colores<-c("palegreen4","green2","orange","burlywood2")
Taao<-ggplot(data=data, aes(Conc, inh, color=data$T)) +
  geom_point(lwd=5, show.legend = FALSE, shape=data$T) +
  (scale_color_manual(values = colores)) +
  geom_smooth(method="loess", lwd=1.2) + labs(y="inh %", x="Concentration mg fruit/Ml") +
  geom_errorbar(aes(ymin=inh-DS, ymax=inh+DS), width=.9, position=position_dodge(.01))+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = c(0.85, 0.25),
        legend.background = element_rect(fill = "white"))+
  theme(text = element_text(size=20))+
  theme(legend.position = "bottom")

Taao

```

## Tabla resumen
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
setwd("C:/Users/um/Documents/ipovilonis/Doc/6 - Producción/web/ipovilonis.github.io")
library(png)
library(grid)
img <- readPNG("varqui.png")
 grid.raster(img)
```

ANOVA for the soluble solids (SS). pH (pH). titulable total acidity (TTA) and soluble solids/ titulable total acidity (SS/TTA). total polyphenols (TP). DPPH radical scavenging activity (DPPH) considering the fruit ripening stages of H. edulis "ubajay" harvested from the plants growing in the experimental field of the University of Morón in Moreno (Buenos Aires) during December 2018.



## Acidos orgánicos en peso fresco

```{r, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

setwd("C:/Users/um/Documents/ipovilonis/Doc/6 - Producción/web/ipovilonis.github.io")
datap<-read.delim("CHac.txt")
datap$CAR <- factor(datap$CAR,
                   levels = c("Sacarosa" ,"Glucosa" ,"Fructosa" ,
                              "TartÃ¡rico","MÃ¡lico","QuÃ­nico",  "SuccÃ­nico", "glufru", "ATT"),
                   labels = c("Sacarosa" ,"Glucosa" ,"Fructosa" ,
                              "Tartárico","Málico","Quínico" ,"Succínico", "glufru", "ATT"))
datap$REP<-as.factor(datap$REP)
datap$CONF<-as.numeric(datap$CONF)
datap$MAD<-factor(datap$MAD,levels=c("I", "MM", "M", "SM"))

data2<-datap[-c(73:168),]
data3<-datap[-c(1:72,169:204),]

```

### Concentración del perfíl de ácidos orgánicos a distintos estados de madurez
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(ggplot2)
g2<-ggplot2::ggplot(data3, aes(x=MAD, y=CONF, fill=MAD, width=1)) +
  geom_boxplot()+
  facet_grid(CAR~.)+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  labs(y="mg/g fruta fresca", x="Madurez")+
  theme_classic()+
  theme(panel.grid.major.y = element_line(size=0.05, color='black'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=20, color='black'))+
  theme(axis.text = element_text(color='black'))+
  theme(legend.title=element_blank())+
  theme(legend.position = "none")+
  theme(legend.position = "none")
g2

```

### Tabla descriptiva
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estadac <- summarySE(data3, measurevar="CONF", groupvars=c("CAR", "MAD"))
estadac

```

### Evolución del perfíl de ácidos orgánicos en la maduración
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

data5<-data3
dataSI<-subset(data5, MAD == "I")
dataSMM<-subset(data5, MAD == "MM")
dataM<-subset(data5, MAD == "M")
dataSSM<-subset(data5, MAD == "SM")


SI<-ggplot(dataSI, aes(x = "CAR", y = CONF, fill = CAR)) +
  geom_col(width = 1) +
  scale_fill_manual(values = c("red","coral","coral3","burlywood2")) +
  coord_polar("y", start = pi / 3) +
  labs(title = "INMADUROS")+
  theme(legend.title = element_blank())+
  xlab("[AO]") + ylab("mg/g fruta fresca")

SMM<-ggplot(dataSMM, aes(x = "CAR", y = CONF, fill = CAR)) +
  geom_col(width = 1) +
  scale_fill_manual(values = c("red","coral","coral3","burlywood2")) +
  coord_polar("y", start = pi / 3) +
  labs(title = "MEDIO MADUROS")+
  theme(legend.title = element_blank())+
  xlab("[AO]") + ylab("mg/g fruta fresca")

SM<-ggplot(dataM, aes(x = "CAR", y = CONF, fill = CAR)) +
  geom_col(width = 1) +
  scale_fill_manual(values = c("red","coral","coral3","burlywood2")) +
  coord_polar("y", start = pi / 3) +
  labs(title = "MADUROS")+
  theme(legend.title = element_blank())+
  xlab("[AO]") + ylab("mg/g fruta fresca")

SSM<-ggplot(dataSSM, aes(x = "CAR", y = CONF, fill = CAR)) +
  geom_col(width = 1) +
  scale_fill_manual(values = c("red","coral","coral3","burlywood2")) +
  coord_polar("y", start = pi / 3) +
  labs(title = "SOBRE MADUROS")+
  theme(legend.title = element_blank())+
  xlab("[AO]") + ylab("mg/g fruta fresca")

library(gridExtra)
grid.arrange(SI, SMM, SM, SSM, ncol = 2)

```

### Acidos orgánicos Totales

```{r, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

dataSACT<-read.delim("SACT.txt")
dataSACT$CAR <- as.factor(dataSACT$CAR)
dataSACT$REP<-as.factor(dataSACT$REP)
dataSACT$TOTALS<-as.numeric(dataSACT$TOTALS)
dataSACT$TOTALF<-as.numeric(dataSACT$TOTALF)
dataSACT$MAD<-factor(dataSACT$MAD,levels=c("I", "MM", "M", "SM"))

dataST<-dataSACT[-c(25:60),]
dataAT<-dataSACT[-c(1:24,49:60),]
dataCT<-dataSACT[-c(1:48),]

```

#### Concentración de ácidos orgánicos totales a distintos estados de madurez.
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

gAT<-ggplot2::ggplot(dataAT, aes(x=MAD, y=TOTALF, fill=MAD)) +
  geom_boxplot(width = 0.50)+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  labs(y="Totales (mg/g fruta fresca)", x="Madurez")+
  # facet_grid(CAR~.)+
  theme_classic()+
  theme(panel.grid.major.y = element_line(size=0.05, color='black'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=20, color='black'))+
  theme(axis.text = element_text(color='black'))+
  theme(legend.title=element_blank())+
  theme(legend.position = "none")+
  theme(legend.position = "none")
gAT

```

#### Tabla descriptiva totales
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estadSACT <- summarySE(dataSACT, measurevar="TOTALF", groupvars=c("CAR", "MAD"))
estadSACT

```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mAT1 <- lme(TOTALF~ MAD, random = ~ 1|REP,
             control = ctrl, data = dataAT)

mAT1

AT_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mAT1),
  "predichos" = predict(mAT1)))

AT_ajuste$AT <- dataAT$TOTALF

library(ggplot2)
HVAT<-ggplot(AT_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVAT

QQAT<-ggplot(AT_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQAT

e<-resid(mAT1) # residuos de pearson
# pre<-predict(mAT1) #predichos
# alfai<-ranef(mAT1)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mAT1)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
CompAT<-emmeans(mAT1, pairwise ~ MAD) #Tukey  
CompAT
plot(CompAT, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración mg/g fruta fresca", y ="Madurez")

```

#### Conclusiones

Existen diferencias significativas entre estados de madurez para los ácidos totales detectados en este trabajo.

### Ácido Tartárico


```{r, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

tar<-subset(datap, CAR == "Tartárico")

# Se quitan outliers
# g_caja<-boxplot(tar$CONF, col="green3", frame.plot=T)
# tar<-tar[!(tar$CONF %in% g_caja$out),]
# g_caja<-boxplot(tar$CONF, col="green3", frame.plot=T)
# tar<-tar[!(tar$CONF %in% g_caja$out),]

```

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mtar2 <- lme(CONF~ MAD, random = ~ 1|REP,
             control = ctrl, data = tar)
mtar2

tar_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mtar2),
  "predichos" = predict(mtar2)))

tar_ajuste$CONF <- tar$CONF

library(ggplot2)
HVtar<-ggplot(tar_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVtar

QQtar<-ggplot(tar_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQtar

e<-resid(mtar2) # residuos de pearson
pre<-predict(mtar2) #predichos
alfai<-ranef(mtar2)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mtar2)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Comptar<-emmeans(mtar2, pairwise ~ MAD) #Tukey  
Comptar
plot(Comptar, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración mg/g fruta fresca", y ="Madurez" )

```

#### Conclusiones

Existen diferencias significativas entre estados de madurez. El estado sobre maduro es el único que presenta ácido tartárico detectable.


### Ácido málico

```{r, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

mal<-subset(datap, CAR == "Málico")
# mal<-mal[-c(2),]
# Se quitan outliers
# g_caja<-boxplot(mal$CONF, col="green3", frame.plot=T)
# mal<-mal[!(mal$CONF %in% g_caja$out),]
# g_caja<-boxplot(mal$CONF, col="green3", frame.plot=T)
# mal<-mal[!(mal$CONF %in% g_caja$out),]

```

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mmal2 <- lme(CONF~ MAD, random = ~ 1|REP,
             weights=varIdent(form=~1|MAD),
             control = ctrl, data = mal)
mmal2

mal_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mmal2),
  "predichos" = predict(mmal2)))

mal_ajuste$CONF <- mal$CONF

library(ggplot2)
HVmal<-ggplot(mal_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVmal

QQmal<-ggplot(mal_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQmal

e<-resid(mmal2) # residuos de pearson
pre<-predict(mmal2) #predichos
alfai<-ranef(mmal2)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mmal2)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Compmal<-emmeans(mmal2, pairwise ~ MAD) #Tukey  
Compmal
plot(Compmal, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración mg/g fruta fresca", y ="Madurez" )

```

#### Conclusiones

Existen diferencias significativas entre estados de madurez. En el estado maduro se presentó el pico de concentración de ácido málico.

### Ácido quínico

#### Modelo y supuestos
```{r, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

qui<-subset(datap, CAR == "Quínico")
# qui2<-qui[5:24,]
# Se quitan outliers
# g_caja<-boxplot(qui2$CONF, col="green3", frame.plot=F)
# qui<-qui2[!(qui2$CONF %in% g_caja$out),]

```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

ctrl <- lmeControl(opt='optim');
mqui2<- lme(CONF~MAD, random = ~ 1|REP,
                  control = ctrl, data = qui)
mqui2

```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

qui_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mqui2),
  "predichos" = predict(mqui2)))

qui_ajuste$CONF <- qui$CONF

library(ggplot2)
HVqui<-ggplot(qui_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVqui

QQqui<-ggplot(qui_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQqui

e<-resid(mqui2) # residuos de pearson
pre<-predict(mqui2) #predichos
alfai<-ranef(mqui2)$REP$'(Intercept)'
shapiro.test(e)
library(car)
leveneTest(CONF~MAD, qui)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mqui2)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Compqui<-emmeans(mqui2, pairwise ~ MAD) #Tukey  
Compqui
plot(Compqui, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración mg/g fruta fresca", y ="Madurez" )

```

#### Conclusiones

Se observa un marcado aumento de ácido quínico con la maduración hasta frutos maduros. Luego en frutos sobre maduros Frutos medio maduros presentan gran variabiliad.

### Ácido succinico

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

suc<-subset(datap, CAR == "Succínico")

ctrl <- lmeControl(opt='optim');
msuc2<-lme(CONF~MAD, random = ~ 1|REP,
           control = ctrl, data = suc)

suc_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(msuc2),
  "predichos" = predict(msuc2)))

suc_ajuste$CONF <- suc$CONF

library(ggplot2)
HVsuc<-ggplot(suc_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVsuc

QQsuc<-ggplot(suc_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQsuc

e<-resid(msuc2) # residuos de pearson
pre<-predict(msuc2) #predichos
alfai<-ranef(msuc2)$REP$'(Intercept)'
shapiro.test(e)
leveneTest(CONF~MAD, suc)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=7}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(msuc2)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Compsuc<-emmeans(msuc2, pairwise ~ MAD) #Tukey  
Compsuc
plot(Compsuc, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración mg/g fruta fresca", y ="Madurez" )

```

#### Conclusiones

Se encontraron diferencias entre estados de madurez, los frutos inmaduros y sobre maduros presentaron las mayores concentraciones de ácido succínico.

## Acidos orgánicos en peso seco

### Concentración del perfíl de ácidos orgánicos a distintos estados de madurez
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(ggplot2)
g2<-ggplot2::ggplot(data3, aes(x=MAD, y=CONS, fill=MAD, width=1)) +
  geom_boxplot()+
  facet_grid(CAR~.)+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  labs(y="mg/g fruta seca", x="Madurez")+
  theme_classic()+
  theme(panel.grid.major.y = element_line(size=0.05, color='black'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=20, color='black'))+
  theme(axis.text = element_text(color='black'))+
  theme(legend.title=element_blank())+
  theme(legend.position = "none")+
  theme(legend.position = "none")
g2

```

#### Tabla descriptiva
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estadacs <- summarySE(data3, measurevar="CONS", groupvars=c("CAR", "MAD"))
estadacs

```

#### Evolución del perfíl de ácidos orgánicos en la maduración
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

data5<-data3
dataSI<-subset(data5, MAD == "I")
dataSMM<-subset(data5, MAD == "MM")
dataM<-subset(data5, MAD == "M")
dataSSM<-subset(data5, MAD == "SM")


SI<-ggplot(dataSI, aes(x = "CAT", y = CONS, fill = CAR)) +
  geom_col(width = 1) +
  scale_fill_manual(values = c("red","coral","coral3","burlywood2")) +
  coord_polar("y", start = pi / 3) +
  labs(title = "INMADUROS")+
  theme(legend.title = element_blank())+
  xlab("") + ylab("mg/g fruta seca")

SMM<-ggplot(dataSMM, aes(x = "CAT", y = CONS, fill = CAR)) +
  geom_col(width = 1) +
  scale_fill_manual(values = c("red","coral","coral3","burlywood2")) +
  coord_polar("y", start = pi / 3) +
  labs(title = "MEDIO MADUROS")+
  theme(legend.title = element_blank())+
  xlab("") + ylab("mg/g fruta seca")

SM<-ggplot(dataM, aes(x = "CAT", y = CONS, fill = CAR)) +
  geom_col(width = 1) +
  scale_fill_manual(values = c("red","coral","coral3","burlywood2")) +
  coord_polar("y", start = pi / 3) +
  labs(title = "MADUROS")+
  theme(legend.title = element_blank())+
  xlab("") + ylab("mg/g fruta seca")

SSM<-ggplot(dataSSM, aes(x = "CAT", y = CONS, fill = CAR)) +
  geom_col(width = 1) +
  scale_fill_manual(values = c("red","coral","coral3","burlywood2")) +
  coord_polar("y", start = pi / 3) +
  labs(title = "SOBRE MADUROS")+
  theme(legend.title = element_blank())+
  xlab("") + ylab("mg/g fruta seca")

library(gridExtra)
grid.arrange(SI, SMM, SM, SSM, ncol = 2)

```

### Ácidos orgánicos totales
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

gAT<-ggplot2::ggplot(dataSACT, aes(x=MAD, y=TOTALS, fill=MAD)) +
  geom_boxplot(width = 0.50)+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  labs(y="Totales (mg/g fruto seca)", x="Madurez")+
  # facet_grid(CAR~.)+
  theme_classic()+
  theme(panel.grid.major.y = element_line(size=0.05, color='black'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=20, color='black'))+
  theme(axis.text = element_text(color='black'))+
  theme(legend.title=element_blank())+
  theme(legend.position = "none")+
  scale_colour_manual(values = c("cyan4", "coral1","green3"))+
  theme(legend.position = "none")
gAT

```

#### Tabla descriptiva totales
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estadSACTS <- summarySE(dataSACT, measurevar="TOTALS", groupvars=c("CAR", "MAD"))
estadSACTS

```

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mAT1s <- lme(TOTALS~ MAD, random = ~ 1|REP,
             control = ctrl, data = dataAT)

mAT1s

ATs_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mAT1s),
  "predichos" = predict(mAT1s)))

ATs_ajuste$AT <- dataAT$TOTALS

library(ggplot2)
HVATs<-ggplot(ATs_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVATs

QQATs<-ggplot(ATs_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQATs

e<-resid(mAT1s) # residuos de pearson
pre<-predict(mAT1s) #predichos
alfai<-ranef(mAT1s)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mAT1s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
CompATs<-emmeans(mAT1s, pairwise ~ MAD) #Tukey  
CompATs
plot(CompATs, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración mg/g fruta fresca", y ="Madurez" )

```

#### Conclusiones

La menor concentración de ácidos totales en frutos inmaduros es significativa.

### Ácido tartárico

```{r, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

tar<-subset(datap, CAR == "Tartárico")

# # Se quitan outliers
# g_caja<-boxplot(tar$CONS, col="green3", frame.plot=T)
# tar<-tar[!(tar$CONS %in% g_caja$out),]
# g_caja<-boxplot(tar$CONS, col="green3", frame.plot=T)
# tar<-tar[!(tar$CONS %in% g_caja$out),]

```

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mtar2s <- lme(CONS ~ MAD, random = ~ 1|REP,
             control = ctrl, data = tar)
mtar2s


tars_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mtar2s),
  "predichos" = predict(mtar2s)))

tars_ajuste$CONS <- tar$CONS

library(ggplot2)
HVtars<-ggplot(tars_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVtars

QQtars<-ggplot(tars_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQtars

e<-resid(mtar2s) # residuos de pearson
pre<-predict(mtar2s) #predichos
alfai<-ranef(mtar2s)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mtar2s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Comptars<-emmeans(mtar2s, pairwise ~ MAD) #Tukey  
Comptars
plot(Comptars, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

Existen diferencias significativas entre estados de madurez. Sólo el estado sobre maduro presentó ácido málico detectable.

### Ácido málico

```{r, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

mal<-subset(datap, CAR == "Málico")

# Se quitan outliers
# g_caja<-boxplot(mal$CONS, col="green3", frame.plot=T)
# mal<-mal[!(mal$CONS %in% g_caja$out),]
# g_caja<-boxplot(mal$CONS, col="green3", frame.plot=T)
# mal<-mal[!(mal$CONS %in% g_caja$out),]

```

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mmal2s <- lme(CONS~ MAD, random = ~ 1|REP,
             weights=varIdent(form=~1|MAD),
             control = ctrl, data = mal)
mmal2s

mals_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mmal2s),
  "predichos" = predict(mmal2s)))

mals_ajuste$CONS <- mal$CONS

library(ggplot2)
HVmals<-ggplot(mals_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVmals

QQmals<-ggplot(mals_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQmals

e<-resid(mmal2s) # residuos de pearson
pre<-predict(mmal2s) #predichos
alfai<-ranef(mmal2s)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mmal2s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Compmals<-emmeans(mmal2s, pairwise ~ MAD) #Tukey  
Compmals
plot(Compmals, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

Existen diferencias significativas entre estados de madurez. En el estado maduro se presentó el pico de concentración de ácido málico.

### Ácido quínico

#### Modelo y supuestos
```{r, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

qui<-subset(datap, CAR == "Quínico")
# qui2<-qui[5:24,]
# Se quitan outliers
# g_caja<-boxplot(qui2$CONS, col="green3", frame.plot=F)
# qui<-qui2[!(qui2$CONS %in% g_caja$out),]

```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

ctrl <- lmeControl(opt='optim');
mqui2s<- lme(CONS~MAD, random = ~ 1|REP,
                  weights=varIdent(form=~1|MAD),
                  control = ctrl, data = qui)
mqui2s

```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)


quis_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mqui2s),
  "predichos" = predict(mqui2s)))

quis_ajuste$CONS <- qui$CONS

library(ggplot2)
HVquis<-ggplot(quis_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVquis

QQquis<-ggplot(quis_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQquis

e<-resid(mqui2s) # residuos de pearson
pre<-predict(mqui2s) #predichos
alfai<-ranef(mqui2s)$REP$'(Intercept)'
shapiro.test(e)
# library(car)
# leveneTest(CONS~MAD, qui)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mqui2s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Compquis<-emmeans(mqui2s, pairwise ~ MAD) #Tukey  
Compquis
plot(Compquis, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

El estado inmaduro se diferenció significativamente por sus bajas concentraciones de quínico. Luego durante la maduración el ácido se mantiene constante.

### Ácido succinico

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

suc<-subset(datap, CAR == "Succínico")
ctrl <- lmeControl(opt='optim');
msuc2s<-lme(CONS~MAD, random = ~ 1|REP,
           control = ctrl, data = suc)

msuc2s

sucs_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(msuc2s),
  "predichos" = predict(msuc2s)))

sucs_ajuste$CONS <- suc$CONS

library(ggplot2)
HVsucs<-ggplot(sucs_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVsucs

QQsucs<-ggplot(sucs_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQsucs

e<-resid(msuc2s) # residuos de pearson
pre<-predict(msuc2s) #predichos
alfai<-ranef(msuc2s)$REP$'(Intercept)'
shapiro.test(e)
leveneTest(CONS~MAD, suc)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=7}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(msuc2s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Compsucs<-emmeans(msuc2s, pairwise ~ MAD) #Tukey  
Compsucs
plot(Compsucs, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

Se encontraron diferencias significativas entre estados de madurez, los frutos inmaduros y sobre maduros presentaron las mayores concentraciones de ácido succínico.



## Carbohidratos en peso fresco

### Concentración de sacáridos a distintos estados de madurez
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

g1<-ggplot(data2, aes(x=MAD, y=CONS, fill=MAD, width=1)) +
 geom_boxplot()+
  facet_grid(CAR~.)+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  labs(y="mg/g fruta fresca", x="Madurez")+
  theme_classic()+
  theme(panel.grid.major.y = element_line(size=0.05, color='black'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=20, color='black'))+
  theme(axis.text = element_text(color='black'))+
  theme(legend.title=element_blank())+
  theme(legend.position = "bottom")+
  geom_point(aes(colour=REP))
g1

```

#### Tabla descriptiva
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estadcar <- summarySE(data2, measurevar="CONS", groupvars=c("CAR", "MAD"))
estadcar

```

#### Evolución del perfíl de sacáridos en la maduración
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

data4<-data2
data4<-data4[-c(73:96),]
dataSI<-subset(data4, MAD == "I")
dataSMM<-subset(data4, MAD == "MM")
dataM<-subset(data4, MAD == "M")
dataSSM<-subset(data4, MAD == "SM")


SI<-ggplot(dataSI, aes(x = "CAT", y = CONS, fill = CAR)) +
  geom_col(width = 1) +
  scale_fill_manual(values = c("coral","coral3","burlywood2","red")) +
  coord_polar("y", start = pi / 3) +
  labs(title = "INMADUROS")+
  theme(legend.title = element_blank())+
  xlab("[TS]") + ylab("mg/g fruta seca")

SMM<-ggplot(dataSMM, aes(x = "CAT", y = CONS, fill = CAR)) +
  geom_col(width = 1) +
  scale_fill_manual(values = c("coral","coral3","burlywood2","red")) +
  coord_polar("y", start = pi / 3) +
  labs(title = "MEDIO MADUROS")+
  theme(legend.title = element_blank())+
  xlab("[TS]") + ylab("mg/g fruta seca")

SM<-ggplot(dataM, aes(x = "CAT", y = CONS, fill = CAR)) +
  geom_col(width = 1) +
  scale_fill_manual(values = c("coral","coral3","burlywood2","red")) +
  coord_polar("y", start = pi / 3) +
  labs(title = "MADUROS")+
  theme(legend.title = element_blank())+
  xlab("[TS]") + ylab("mg/g fruta seca")

SSM<-ggplot(dataSSM, aes(x = "CAT", y = CONS, fill = CAR)) +
  geom_col(width = 1) +
  scale_fill_manual(values = c("coral","coral3","burlywood2","red")) +
  coord_polar("y", start = pi / 3) +
  labs(title = "SOBRE MADUROS")+
  theme(legend.title = element_blank())+
  xlab("[TS]") + ylab("mg/g fruta seca")

library(gridExtra)
grid.arrange(SI, SMM, SM, SSM, ncol = 2)

```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
sac<-subset(datap, CAR == "Sacarosa")
glu<-subset(datap, CAR == "Glucosa")
fru<-subset(datap, CAR == "Fructosa")
glufru<-subset(datap, CAR == "glufru")

```

### Carbohidratos Totales

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

gST<-ggplot2::ggplot(dataST, aes(x=MAD, y=TOTALF, fill=MAD)) +
  geom_boxplot(width = 0.50)+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  labs(y="Totales (mg/g fruta fresca)", x="Madurez")+
  # facet_grid(CAR~.)+
  theme_classic()+
  theme(panel.grid.major.y = element_line(size=0.05, color='black'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=20, color='black'))+
  theme(axis.text = element_text(color='black'))+
  theme(legend.title=element_blank())+
  theme(legend.position = "none")+
  theme(legend.position = "none")
gST

```

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mST1 <- lme(TOTALF~ MAD, random = ~ 1|REP,
             control = ctrl, data = dataST)

mST1


ST_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mST1),
  "predichos" = predict(mST1)))

ST_ajuste$CONF <- dataST$TOTALF

library(ggplot2)
HVST<-ggplot(ST_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVST

QQST<-ggplot(ST_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQST

e<-resid(mST1) # residuos de pearson
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mST1)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
CompmST1<-emmeans(mST1, pairwise ~ MAD) #Tukey  
CompmST1
plot(CompmST1, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración mg/g fruta fresca", y ="Madurez" )

```

#### Conclusiones

La concentración de azúcares totales es significativamente superior durante la fructificación en frutos inmaduros, luego decae y durante la maduración aumentan nuevamente. Los frutos sobre maduros se diferenciaron singnificativamente de los maduro y medio maduros en su contenido de azúcares totales.

### Sacarosa

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(lme4)
ctrl <- lmeControl(opt='optim');
msac2<-lme(CONF~MAD, random = ~ 1|REP,
           control = ctrl, data = sac)
msac2

sac_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(msac2),
  "predichos" = predict(msac2)))

sac_ajuste$CONF <- sac$CONF

library(ggplot2)
HVsac<-ggplot(sac_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVsac

QQsac<-ggplot(sac_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQsac

e<-resid(msac2) # residuos de pearson
pre<-predict(msac2) #predichos
alfai<-ranef(msac2)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

# library(car)
anova(msac2)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Compsac<-emmeans(msac2, pairwise ~ MAD) #Tukey  
Compsac
plot(Compsac, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

Los frutos inmaduros tuvieron una concentración de sacarosa significativamente menor.

### Glucosa

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(lme4)
ctrl <- lmeControl(opt='optim');
mglu2<-lme(CONF~MAD, random = ~ 1|REP,
           control = ctrl, data = glu)
mglu2

glu_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mglu2),
  "predichos" = predict(mglu2)))

glu_ajuste$CONF <- glu$CONF

library(ggplot2)
HVglu<-ggplot(glu_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVglu

QQglu<-ggplot(glu_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQglu

e<-resid(mglu2) # residuos de pearson
pre<-predict(mglu2) #predichos
alfai<-ranef(mglu2)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

# library(car)
anova(mglu2)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Compglu<-emmeans(mglu2, pairwise ~ MAD) #Tukey  
Compglu
plot(Compglu, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

### Fructosa

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(lme4)
ctrl <- lmeControl(opt='optim');
mfru2<-lme(CONF~MAD, random = ~ 1|REP,
           control = ctrl, data = fru)
mfru2

fru_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mfru2),
  "predichos" = predict(mfru2)))

fru_ajuste$CONF <- fru$CONF

library(ggplot2)
HVfru<-ggplot(fru_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVfru

QQfru<-ggplot(fru_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQfru

e<-resid(mfru2) # residuos de pearson
pre<-predict(mfru2) #predichos
alfai<-ranef(mfru2)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

# library(car)
anova(mfru2)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Compfru<-emmeans(mfru2, pairwise ~ MAD) #Tukey  
Compfru
plot(Compfru, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones


## Carbohidratos en peso seco

### Carbohidratos Totales

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

gSTs<-ggplot2::ggplot(dataST, aes(x=MAD, y=TOTALF, fill=MAD)) +
  geom_boxplot(width = 0.50)+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  labs(y="Totales (mg/g fruto seco)", x="Madurez")+
  # facet_grid(CAR~.)+
  theme_classic()+
  theme(panel.grid.major.y = element_line(size=0.05, color='black'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=20, color='black'))+
  theme(axis.text = element_text(color='black'))+
  theme(legend.title=element_blank())+
  theme(legend.position = "none")+
  scale_colour_manual(values = c("cyan4", "coral1","green3"))+
  theme(legend.position = "none")
gSTs

```

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mST1s <- lme(TOTALS~ MAD, random = ~ 1|REP,
             control = ctrl, data = dataST)

mST1s


STs_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mST1),
  "predichos" = predict(mST1)))

STs_ajuste$ST <- dataST$TOTALS

library(ggplot2)
HVSTs<-ggplot(STs_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVSTs

QQSTs<-ggplot(STs_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQSTs

e<-resid(mST1s) # residuos de pearson
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mST1s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
CompmST1s<-emmeans(mST1s, pairwise ~ MAD) #Tukey  
CompmST1s
plot(CompmST1s, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración mg/g fruta fresca", y ="Madurez" )

```

#### Conclusiones


### Sacarosa

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(lme4)
ctrl <- lmeControl(opt='optim');
msac2s<-lme(CONS~MAD, random = ~ 1|REP,
           control = ctrl, data = sac)
msac2s

sacs_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(msac2s),
  "predichos" = predict(msac2s)))

sacs_ajuste$CONS <- sac$CONS

library(ggplot2)
HVsacs<-ggplot(sacs_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVsacs

QQsacs<-ggplot(sacs_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQsacs

e<-resid(msac2) # residuos de pearson
pre<-predict(msac2) #predichos
alfai<-ranef(msac2)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

# library(car)
anova(msac2s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
emm_options(opt.digits = FALSE)
Compsacs<-emmeans(msac2s, pairwise ~ MAD) #Tukey  
Compsacs
plot(Compsacs, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones
Se encontraron diferencias significativas entre estados de madurez. Los frutos maduros tendrían mayor concentración de sacarosa, no se diferenciaron de los frutos medios maduros.

### Glucosa

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mglu2s <- lme(CONS ~ MAD, random = ~ 1|REP,
             weights=varIdent(form=~1|MAD),
             control = ctrl,data = glu)
mglu2s

glus_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mglu2s),
  "predichos" = predict(mglu2s)))

glus_ajuste$CONS <- glu$CONS

library(ggplot2)
HVglus<-ggplot(glus_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVglus

QQglus<-ggplot(glus_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQglus


e<-resid(mglu2s) # residuos de pearson
pre<-predict(mglu2s) #predichos
alfai<-ranef(mglu2s)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

# library(car)
anova(mglu2s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Compglus<-emmeans(mglu2s, pairwise ~ MAD) #Tukey  
Compglus
plot(Compglus, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones
Se encontraron diferencias significativas entre estados de madurez.

### Fructosa

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(lme4)
ctrl <- lmeControl(opt='optim');
mfru2s<-lme(CONS~MAD, random = ~ 1|REP,
           control = ctrl, data = fru)
mfru2s

frus_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mfru2s),
  "predichos" = predict(mfru2s)))

frus_ajuste$CONS <- fru$CONS

library(ggplot2)
HVfrus<-ggplot(frus_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVfrus

QQfrus<-ggplot(frus_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQfrus

e<-resid(mfru2s) # residuos de pearson
pre<-predict(mfru2s) #predichos
alfai<-ranef(mfru2s)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

# library(car)
anova(mfru2s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Compfrus<-emmeans(mfru2s, pairwise ~ MAD) #Tukey  
Compfrus
plot(Compfrus, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones
Se encontraron diferencias significativas entre estados de madurez. Los frutos sobre maduros tendrían mayor concentración de fructosa.

### Glucosa/Fructosa


```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(lme4)
ctrl <- lmeControl(opt='optim');
mglufru2s<-lme(CONS~MAD, random = ~ 1|REP,
              weights=varIdent(form=~1|MAD),
              control = ctrl, data = glufru)
mglufru2s

glufrus_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mglufru2s),
  "predichos" = predict(mglufru2s)))

glufrus_ajuste$CONS <- glufru$CONS

library(ggplot2)
HVglufrus<-ggplot(glufrus_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVglufrus

QQglufrus<-ggplot(glufrus_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQglufrus

e<-resid(mglufru2s) # residuos de pearson
pre<-predict(mglufru2s) #predichos
alfai<-ranef(mglufru2s)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

# library(car)
anova(mglufru2s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Compglufrus<-emmeans(mglufru2s, pairwise ~ MAD) #Tukey  
Compglufrus
plot(Compglufrus, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

La relación glucosa/fructosa es significativamente mayor en frutos sobre maduros.

## Cationes en peso fresco

Aproximadamente 1 gr de cada  muestra fue calcinado en mufla a 500 ºC por 5 horas.
La ceniza fue levantada con 5 mL de HCl 20 %, completado a volumen (50mL) con agua destilada. Filtrada y  cuantificada por espectrometría de Absorción Atómica  en un equipo Perkin Elmer  AAAnalyst 200.

Se ajustaron modelos lineales (estimaciones por mínimos cuarados ordinarios OLS) para predecir las concentraciones (CON) de cationes minerales en función del estado de madurez (MAD).
```{r, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
setwd("C:/Users/um/Documents/ipovilonis/Doc/6 - Producción/web/ipovilonis.github.io")
data<-read.delim("cationes.txt")
data$MAD<-as.factor(data$MAD)
data$CAR<-as.factor(data$CAR)
data$MAD<-factor(data$MAD,levels=c("I", "MM", "M", "SM"))
data[is.na(data)] <-  0
mg<-data[1:12,]
k<-data[13:24,]
mn<-data[25:36,]
```

### Tablas descriptivas

#### Mg
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estadcatmg <- summarySE(mg, measurevar="CONF", groupvars=c("MAD"))
estadcatmg

```

#### K
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

estadcatk <- summarySE(k, measurevar="CONF", groupvars=c("MAD"))
estadcatk

```

#### Mn
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

estadcatmn <- summarySE(mn, measurevar="CONF", groupvars=c("MAD"))
estadcatmn

```

#### Concentración de cationes totales a distintos estados de madurez.
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

gCT<-ggplot2::ggplot(dataCT, aes(x=MAD, y=TOTALF, fill=MAD)) +
  geom_boxplot(width = 0.50)+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  labs(y="Totales (mg/g fruta fresca)", x="Madurez")+
  # facet_grid(CAR~.)+
  theme_classic()+
  theme(panel.grid.major.y = element_line(size=0.05, color='black'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=20, color='black'))+
  theme(axis.text = element_text(color='black'))+
  theme(legend.title=element_blank())+
  theme(legend.position = "none")+
  theme(legend.position = "none")
gCT

```

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mCT1 <- lme(TOTALF~ MAD, random = ~ 1|REP,
             control = ctrl, data = dataCT)

mCT1

CT_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mCT1),
  "predichos" = predict(mCT1)))

CT_ajuste$CT <- dataCT$TOTALF

library(ggplot2)
HVCT<-ggplot(CT_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVCT

QQCT<-ggplot(CT_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQCT

e<-resid(mCT1) # residuos de pearson
# pre<-predict(mCT1) #predichos
# alfai<-ranef(mCT1)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mCT1)

```

#### Conclusiones

No hay diferencias significativas.

### Magnesio

#### Concentración de magnesio a distintos estados de madurez.

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(ggplot2)
gmg<-ggplot(mg, aes(x=MAD, y=CONF, fill=MAD))+
  geom_boxplot()+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  labs(y="Concentración de Mg (mg/g) de peso fresco de fruto", x="Madurez")+
  theme_classic()+
  theme(panel.grid.major.y = element_line(size=0.05, color='black'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=20, color='black'))+
  theme(axis.text = element_text(color='black'))+
  theme(legend.title=element_blank())+
  theme(legend.position = "none")+
  geom_hline(yintercept = 0)+
  geom_point(aes(x=3, y=0.1115), colour="red", size=2, shape=18) + #Rozycki 1997
  annotate("text", x = c(3), y = c(0.139), label = c("Rozycki et al., 1997"))+
  geom_point(aes(x=3, y=0.11), colour="green", size=2, shape=8) + #Kinupp
  annotate("text", x = c(3), y = c(0.109), label = c("Kinupp-Barros, 2008"))+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))
gmg

```
* Kinupp-Barros, 2008. https://www.scielo.br/j/cta/a/YVFJFF7hsmZKq9BQFcQ5Yyy/?lang=pt&format=pdf
* Rozycki *et al*., 1997. https://pesquisa.bvsalud.org/portal/resource/pt/lil-228290

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
library(lme4)
ctrl <- lmeControl(opt='optim');
mmg2<-lme(CONF~MAD, random = ~ 1|REP,
           control = ctrl, data = mg)
mmg2

mg_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mmg2),
  "predichos" = predict(mmg2)))

mg_ajuste$CONS <- mg$CONS

library(ggplot2)
HVmg<-ggplot(mg_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVmg

QQmg<-ggplot(mg_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQmg

e<-resid(mmg2) # residuos de pearson
pre<-predict(mmg2) #predichos
alfai<-ranef(mmg2)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
anova(mmg2)
```

#### Conclusiones

No se encontraron diferencias significativas.

### Potasio

#### Concentración de potasio a distintos estados de madurez.

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

gk<-ggplot(k, aes(x=MAD, y=CONF, fill=MAD))+
  geom_boxplot()+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  labs(y="Concentración de K (mg/g) de peso fresco de fruto", x="Madurez")+
  theme_classic()+
  theme(panel.grid.major.y = element_line(size=0.05, color='black'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=20, color='black'))+
  theme(axis.text = element_text(color='black'))+
  theme(legend.title=element_blank())+
  theme(legend.position = "none")+
  geom_hline(yintercept = 0)+
  geom_point(aes(x=3, y=0.97), colour="blue4", size=5, shape=18)+
  geom_point(aes(x=3, y=0.9485), colour="red", size=2, shape=18)+ #Rozycki
  annotate("text", x = c(3.5, 3), y = c(1.2, 1.1), label = c("Rozycki et al.,1997", "UNLu"))
gk

```

*UNLu: http://www.argenfoods.unlu.edu.ar/Tablas/Grupo/Frutas.pdf

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
library(lme4)
ctrl <- lmeControl(opt='optim');
mk2<-lme(CONF~MAD, random = ~ 1|REP,
           control = ctrl, data = k)
mk2

k_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mk2),
  "predichos" = predict(mk2)))

k_ajuste$CONS <- k$CONS

library(ggplot2)
HVk<-ggplot(k_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVk

QQk<-ggplot(k_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQk

e<-resid(mk2) # residuos de pearson
pre<-predict(mk2) #predichos
alfai<-ranef(mk2)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mk2)

```

#### Conclusiones

No hay diferencias significativas en la concentración de potasio a diferentes estados de madurez.

### Manganeso

#### Concentración de manganeso a distintos estados de madurez.

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)


gmn<-ggplot(mn, aes(x=MAD, y=CONF, fill=MAD))+
  geom_hline(yintercept=0, col="darkgray")+
  geom_boxplot()+
  geom_point()+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  labs(y="Concentración de Mn (mn/g) de peso fresco de fruto", x="Madurez")+
  theme_classic()+
  theme(panel.grid.major.y = element_line(size=0.05, color='black'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=20, color='black'))+
  theme(axis.text = element_text(color='black'))+
  theme(legend.title=element_blank())+
  theme(legend.position = "none")+
  ggtitle("")+
  geom_hline(yintercept = 0)
gmn

```

#### Modelo y supuestos

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
library(lme4)
ctrl <- lmeControl(opt='optim');
mmn2<-lme(CONF~MAD, random = ~ 1|REP, # Revisar REP !!!!!
           control = ctrl, data = mn)
mmn2

mn_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mmn2),
  "predichos" = predict(mmn2)))

mn_ajuste$CONF <- mn$CONF

library(ggplot2)
HVmn<-ggplot(mn_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVmn

QQmn<-ggplot(mn_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQmn

e<-resid(mmn2) # residuos de pearson
pre<-predict(mmn2) #predichos
alfai<-ranef(mmn2)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mmn2)

```

#### Conclusiones

No hay diferencias significativas en la concentración de manganeso a diferentes estados de madurez. Se observó que sólo en estados medio maduro y maduro aparece en muy bajas concentraciones.


## Cationes en peso seco

### Tablas descriptivas

#### Mg
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estadcatmg <- summarySE(mg, measurevar="CONS", groupvars=c("MAD"))
estadcatmg
```

#### k
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

estadcatk <- summarySE(k, measurevar="CONS", groupvars=c("MAD"))
estadcatk
```

#### Mn
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

estadcatmn <- summarySE(mn, measurevar="CONS", groupvars=c("MAD"))
estadcatmn
```

#### Totales

#### Tabla descriptiva totales
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estadCT <- summarySE(dataCT, measurevar="TOTALS", groupvars=c("CAR", "MAD"))
estadCT

```

### Concentración de cationes totales a distintos estados de madurez.
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

gCTs<-ggplot2::ggplot(dataCT, aes(x=MAD, y=TOTALS, fill=MAD)) +
  geom_boxplot(width = 0.50)+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  labs(y="Totales (mg/g fruto seco)", x="Madurez")+
  # facet_grid(CAR~.)+
  theme_classic()+
  theme(panel.grid.major.y = element_line(size=0.05, color='black'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=20, color='black'))+
  theme(axis.text = element_text(color='black'))+
  theme(legend.title=element_blank())+
  theme(legend.position = "none")+
  scale_colour_manual(values = c("cyan4", "coral1","green3"))+
  theme(legend.position = "none")
gCTs

```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mCT1s <- lme(TOTALS~ MAD, random = ~ 1|REP,
             control = ctrl, data = dataCT)

mCT1s

CTs_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mCT1s),
  "predichos" = predict(mCT1s)))

CTs_ajuste$CT <- dataCT$TOTALS

library(ggplot2)
HVCTs<-ggplot(CTs_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVCTs

QQCTs<-ggplot(CTs_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQCTs

e<-resid(mCT1s) # residuos de pearson
# pre<-predict(mCT1) #predichos
# alfai<-ranef(mCT1)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mCT1s)

```

#### Conclusiones

### Magnesio

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
library(lme4)
ctrl <- lmeControl(opt='optim');
mmg2s<-lme(CONS~MAD, random = ~ 1|REP,
           control = ctrl, data = mg)
mmg2s

mgs_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mmg2s),
  "predichos" = predict(mmg2s)))

mgs_ajuste$CONS <- mg$CONS

library(ggplot2)
HVmgs<-ggplot(mgs_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVmgs

QQmgs<-ggplot(mgs_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQmgs

e<-resid(mmg2s) # residuos de pearson
pre<-predict(mmg2s) #predichos
alfai<-ranef(mmg2s)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
anova(mmg2)
```

#### Conclusiones

No se encontraron diferencias significativas.

### Potasio

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
library(lme4)
ctrl <- lmeControl(opt='optim');
mk2s<-lme(CONS~MAD, random = ~ 1|REP,
           control = ctrl, data = k)
mk2s

ks_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mk2s),
  "predichos" = predict(mk2s)))

ks_ajuste$CONS <- k$CONS

library(ggplot2)
HVks<-ggplot(ks_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVks

QQks<-ggplot(ks_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQks

e<-resid(mk2s) # residuos de pearson
pre<-predict(mk2s) #predichos
alfai<-ranef(mk2s)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mk2s)

```

#### Conclusiones

No hay diferencias significativas en la concentración de potasio a diferentes estados de madurez.

### Manganeso

#### Modelo y supuestos

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
library(lme4)
ctrl <- lmeControl(opt='optim');
mmn2s<-lme(CONS~MAD, random = ~ 1|REP, # Revisar REP !!!!!
           control = ctrl, data = mn)
mmn2s

mns_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mmn2s),
  "predichos" = predict(mmn2s)))

mns_ajuste$CONS <- mn$CONS

library(ggplot2)
HVmns<-ggplot(mns_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVmns

QQmns<-ggplot(mns_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQmns

e<-resid(mmn2s) # residuos de pearson
pre<-predict(mmn2s) #predichos
alfai<-ranef(mmn2s)$REP$'(Intercept)'
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mmn2s)

```

#### Conclusiones


## Fibra Dietaria en peso fresco

```{r, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
 
dataf<-read.delim("fibras.txt")
dataf$MAD<-factor(dataf$MAD,levels=c("I", "MM", "M", "SM"))
FDSdata<-subset(dataf, CAR == "FDS")
FDIdata<-subset(dataf, CAR == "FDI")
FDTdata<-subset(dataf, CAR == "FDT")
IDdata<-subset(dataf, CAR == "IS")
DSTdata<-subset(dataf, CAR == "DT")


```

### Concentración de Fibras dietarias a distintos estados de madurez
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(ggplot2)
fib2<-ggplot2::ggplot(dataf, aes(x=MAD, y=CONF, fill=MAD, width=1)) +
  geom_boxplot()+
  facet_grid(CAR~.)+
  scale_fill_manual(values=c("palegreen4","green2","orange","burlywood2"))+
  labs(y="mg/100g fruta fresca", x="Madurez")+
  theme_classic()+
  theme(panel.grid.major.y = element_line(size=0.05, color='black'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=20, color='black'))+
  theme(axis.text = element_text(color='black'))+
  theme(legend.title=element_blank())+
  theme(legend.position = "none")+
  scale_colour_manual(values = c("cyan4", "coral1","green3"))+
  theme(legend.position = "none")
fib2

```

### Tabla descriptiva
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estadfib <- summarySE(dataf, measurevar="CONF", groupvars=c("CAR", "MAD"))
estadfib

estadfibs <- summarySE(dataf, measurevar="CONS", groupvars=c("CAR", "MAD"))


```

### Fibra Dietaria Soluble

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mFDS2 <- lm(CONF ~ MAD,
             control = ctrl, data = FDSdata)
mFDS2


FDS_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mFDS2),
  "predichos" = predict(mFDS2)))

FDS_ajuste$CONF <- FDSdata$CONF

library(ggplot2)
HVFDS<-ggplot(FDS_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVFDS

QQFDS<-ggplot(FDS_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQFDS

e<-resid(mFDS2) # residuos de pearson
pre<-predict(mFDS2) #predichos
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mFDS2)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
CompFDS<-emmeans(mFDS2, pairwise ~ MAD) #Tukey  
CompFDS
plot(CompFDS, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

Hay diferencias significativas.

### Fibra Dietaria Insoluble

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mFDI2 <- lm(CONF ~ MAD,
             control = ctrl, data = FDIdata)
mFDI2


FDI_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mFDI2),
  "predichos" = predict(mFDI2)))

FDI_ajuste$CONF <- FDIdata$CONF

library(ggplot2)
HVFDI<-ggplot(FDI_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVFDI

QQFDI<-ggplot(FDI_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQFDI

e<-resid(mFDI2) # residuos de pearson
pre<-predict(mFDI2) #predichos
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mFDI2)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
CompFDI<-emmeans(mFDI2, pairwise ~ MAD) #Tukey  
CompFDI
plot(CompFDI, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

No hay diferencias significativas.




### Fibra Dietaria Total

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mFDT2 <- lm(CONF ~ MAD,
             control = ctrl, data = FDTdata)
mFDT2


FDT_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mFDT2),
  "predichos" = predict(mFDT2)))

FDT_ajuste$CONF <- FDTdata$CONF

library(ggplot2)
HVFDT<-ggplot(FDT_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVFDT

QQFDT<-ggplot(FDT_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQFDT

e<-resid(mFDT2) # residuos de pearson
pre<-predict(mFDT2) #predichos
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mFDT2)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
CompFDT<-emmeans(mFDT2, pairwise ~ MAD) #Tukey  
CompFDT
plot(CompFDT, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

Hay diferencias significativas.

## Fibra Dietaria en peso seco
### Fibra Dietaria Soluble

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mFDS2s <- lm(CONS ~ MAD,
             control = ctrl, data = FDSdata)
mFDS2s


FDSs_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mFDS2s),
  "predichos" = predict(mFDS2s)))

FDSs_ajuste$CONS <- FDSdata$CONS

library(ggplot2)
HVFDSs<-ggplot(FDSs_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVFDSs

QQFDSs<-ggplot(FDSs_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQFDSs

e<-resid(mFDS2s) # residuos de pearson
pre<-predict(mFDS2s) #predichos
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mFDS2s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
CompFDSs<-emmeans(mFDS2s, pairwise ~ MAD) #Tukey  
CompFDSs
plot(CompFDSs, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

Hay diferencias significativas.

### Fibra Dietaria Insoluble

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mFDI2s <- lm(CONS ~ MAD,
             control = ctrl, data = FDIdata)
mFDI2s


FDIs_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mFDI2s),
  "predichos" = predict(mFDI2s)))

FDIs_ajuste$CONS <- FDIdata$CONS

library(ggplot2)
HVFDIs<-ggplot(FDIs_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVFDIs

QQFDIs<-ggplot(FDIs_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQFDIs

e<-resid(mFDI2s) # residuos de pearson
pre<-predict(mFDI2s) #predichos
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mFDI2s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
CompFDIs<-emmeans(mFDI2s, pairwise ~ MAD) #Tukey  
CompFDIs
plot(CompFDIs, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

No hay diferencias significativas.

### Fibra Dietaria Total

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mFDT2s <- lm(CONS ~ MAD,
             control = ctrl, data = FDTdata)
mFDT2s


FDTs_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mFDT2s),
  "predichos" = predict(mFDT2s)))

FDTs_ajuste$CONF <- FDTdata$CONF

library(ggplot2)
HVFDTs<-ggplot(FDTs_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVFDTs

QQFDTs<-ggplot(FDTs_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQFDTs

e<-resid(mFDT2s) # residuos de pearson
pre<-predict(mFDT2s) #predichos
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mFDT2s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
CompFDTs<-emmeans(mFDT2s, pairwise ~ MAD) #Tukey  
CompFDTs
plot(CompFDTs, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

Hay diferencias significativas.

### Fibra Dietaria Insoluble/Soluble

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mID2s <- gls(CONS~MAD,
                  weights=varIdent(form=~1|MAD),
                  control = ctrl, data = IDdata)
mID2s


IDs_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mID2s),
  "predichos" = predict(mID2s)))

IDs_ajuste$CONF <- IDdata$CONF

library(ggplot2)
HVIDs<-ggplot(IDs_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVIDs

QQIDs<-ggplot(IDs_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQIDs

e<-resid(mID2s) # residuos de pearson
pre<-predict(mID2s) #predichos
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mID2s)
library(car)
Anova(mID2s, type="3")

```
#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
CompIDs<-emmeans(mID2s, pairwise ~ MAD) #Tukey  
CompIDs
plot(CompIDs, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

NO hay diferencias significativas.

### Fibra Dietaria Soluble/Total %

#### Modelo y supuestos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(nlme)
ctrl <- lmeControl(opt='optim');
mDST2s <- lm(CONS ~ MAD,
             control = ctrl, data = DSTdata)
mDST2s


DSTs_ajuste <- as.data.frame(cbind(
  "residuos" = residuals(mDST2s),
  "predichos" = predict(mDST2s)))

DSTs_ajuste$CONF <- DSTdata$CONF

library(ggplot2)
HVDSTs<-ggplot(DSTs_ajuste) +
  aes(predichos, residuos) +
  geom_hline(yintercept = 0, colour="white", size=2) +
  geom_point(colour="white")+
  theme_classic()+
  labs(y="Residuals", x="Predicted values")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
HVDSTs

QQDSTs<-ggplot(DSTs_ajuste) +
  aes(sample = residuos) +
  geom_qq(shape = 1, colour="white") +
  geom_qq_line(colour="white")+
  theme_classic()+
  labs(y="Sample Quantiles", x="Theoretical Quantiles")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))
QQDSTs

e<-resid(mDST2s) # residuos de pearson
pre<-predict(mDST2s) #predichos
shapiro.test(e)

```

#### Anova
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(mDST2s)

```

#### Test de Tukey
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
CompDSTs<-emmeans(mDST2s, pairwise ~ MAD) #Tukey  
CompDSTs
plot(CompDSTs, comparisons = TRUE) + theme_classic() + 
  labs(x = "Concentración", y ="Madurez" )

```

#### Conclusiones

Hay diferencias significativas.

## Tablas resumen
### Acids
```{r,fig.align='center',echo=FALSE}
setwd("C:/Users/um/Documents/ipovilonis/Doc/6 - Producción/web/ipovilonis.github.io")
library(png)
library(grid)
img <- readPNG("acidos.png")
grid.raster(img)
```

### Sugars
```{r,fig.align='center',echo=FALSE}
setwd("C:/Users/um/Documents/ipovilonis/Doc/6 - Producción/web/ipovilonis.github.io")
library(png)
library(grid)
img <- readPNG("azucares.png")
grid.raster(img)
```

### Cations
```{r,fig.align='center',echo=FALSE}
setwd("C:/Users/um/Documents/ipovilonis/Doc/6 - Producción/web/ipovilonis.github.io")
library(png)
library(grid)
img <- readPNG("cationes.png")
grid.raster(img)
```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(lattice)
library(Rmisc)
estmal <- summarySE(mal, measurevar="CONS", groupvars=c("MAD"))
estqui <- summarySE(qui, measurevar="CONS", groupvars=c("MAD"))
estsuc <- summarySE(suc, measurevar="CONS", groupvars=c("MAD"))
estsac <- summarySE(sac, measurevar="CONS", groupvars=c("MAD"))
estglu <- summarySE(glu, measurevar="CONS", groupvars=c("MAD"))
estfru <- summarySE(fru, measurevar="CONS", groupvars=c("MAD"))
estmg <- summarySE(mg, measurevar="CONS", groupvars=c("MAD"))
estk <- summarySE(k, measurevar="CONS", groupvars=c("MAD"))
estmn <- summarySE(mn, measurevar="CONS", groupvars=c("MAD"))
```

### Dietary fibers

```{r,fig.align='center',echo=FALSE}

library(png)
library(grid)
img <- readPNG("fibras.png")
grid.raster(img)
```



Nota: *Se ajustaron modelos lineales mixtos (estimaciones por máxima verosimilitud restringida REML) para predecir las concentraciones (CON) de ácidos y sacáridos en función del estado de madurez (MAD). Las repeticiones (REP) fueron incluidas como efectos aleatorios.*

## Correlaciones ácidos orgánicos y acidez total titulable ATT.

### Tabla de ácidos
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

corACn<-datap[-c(1:72,169:192),]
library(Rmisc)
estACcor <- summarySE(corACn, measurevar="CONS", groupvars=c("CAR","MAD"))
estadATcor<-subset(estadSACTS, CAR == "ACIDS")
estadATcor$CONS<-estadATcor$TOTALS
estadATcor<-estadATcor[,-c(4)]
estadATcor<-estadATcor[, c(1,2,3,7,4,5,6)] 
CTac<-rbind(estACcor,estadATcor)
CTac

```

### Comparación del perfil de ácidos y de ATT
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(ggplot2)
GCac<-ggplot(CTac) +
  aes(MAD, CONS, fill=CAR, color=CAR) +
  geom_point()+
  scale_color_manual(values=c("aquamarine4","springgreen3","burlywood1","khaki3","coral1","tan3"))+
  scale_fill_manual(values=c("aquamarine4","springgreen3","burlywood1","khaki3","coral1","tan3"))+
  stat_summary(fun = "mean", size = 6, geom = "point") +
  geom_errorbar(aes(ymin=CONS-sd, ymax=CONS+sd),
                width=0, position=position_dodge(0)) +
  theme_classic()+
  labs(y="[mg/g dry fruit] for acids. %*100 for ATT", x="Maturity")+
  theme(legend.position = "bottom", legend.background = element_rect(fill = "gray12"))+
  theme(panel.grid.major.y = element_line(size=0.05, color='white'))+
  theme(panel.grid.major.x = element_blank())+
  theme(text = element_text(size=10, color='white'))+
  theme(axis.text = element_text(color='white'))+
  theme(plot.background = element_rect(fill = "gray12"))+
  theme(panel.background = element_rect(fill = "gray12", color = "white"))+
  theme(legend.title = element_text("none"))
GCac

```
*The bars indicate standard deviation.*

### Correlaciones
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
# 
# NTCac<-CTac[,-c(3,5:7)]
# NTCac<-spread(data = NTCac, key = CAR, value = CONS)
# 
# library(GGally)
# GCOR<-ggpairs(NTCac, columns = 2:7,lower = list(continuous = "points"))
# GCOR
```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

FACO<-read.delim("acidcor.txt")
FACO$MAD<-factor(FACO$MAD,levels=c("I", "MM", "M", "SM"))
colnames(FACO) <- c("MAD","Tartárico","Málico","Quínico" ,"Succínico","ACIDS","ATT")
FACO$Tartárico<-as.numeric(FACO$Tartárico)
FACO$Málico<-as.numeric(FACO$Málico)

library(GGally)
GCORfaco<-ggpairs(FACO, columns = 2:7,lower = list(continuous = "points"))
GCORfaco

```

#### Análisis de varianza para cada ácido orgánico y totales sobre la ATT
```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

MRLMtar<-lm(data = FACO, ATT~Tartárico)
MRLMmal<-lm(data = FACO, ATT~Málico)
MRLMqui<-lm(data = FACO, ATT~Quínico)
MRLMsuc<-lm(data = FACO, ATT~Succínico)
MRLMaci<-lm(data = FACO, ATT~ACIDS)
anova(MRLMtar)
anova(MRLMmal)
anova(MRLMqui)
anova(MRLMsuc)
anova(MRLMaci)

```

#### Conclusión
Sólo la correlación con Ac. tartárico es significativa, sin embargo se encuentra en pequeñas trazas sólo en el fruto sobremaduro. Se concluye que la ATT no se correlaciona con los ácidos orgánicos estudiados por separado ni tampoco en su conjunto (totales). El perfíl de ácidos es relativamente constante.
