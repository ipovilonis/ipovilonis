---
title: "Physical"
output:
 html_document:
   toc: true
   toc_depth: 5
   toc_float:
     collapsed: false
     smooth_scroll: true
---

The aim of this work was to study the evolution of fruit size and weight together with the
soluble solid and total titratable acidity contents with the patterns of accumulation of chlorophylls, carotenoids, color_L and antioxidant activity during ripening of *Hexachlamys edulis* fruits, to understand the optimal time and conditions needed to obtain maximum nutraceutical characteristics. Fruits were harvested from H. edulis plants growing at the experimental field of the University of Morón (Moreno, Buenos Aires, 34°35'4.98" SL, 58°48'52.09" WL, 14 m.a.s.l.).

```{r pressure, echo=FALSE, error=TRUE, fig.cap="A caption", out.width = '100%'}
knitr::include_graphics("IMG_mat.jpg")
```

# Variables físicas

## Peso fresco del fruto (PFF)

```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
# #setwd("C:/Users/um/Documents/ipovilonis/Doc/6 - Producción/web/ipovilonis.github.io")
library(readxl)
data<-read_excel("database.xlsx", sheet="madurez")
data$MADUREZ<-as.factor(data$MADUREZ)
data$MADUREZ<-factor(data$MADUREZ,levels=c("Inmaduro", "Medio Maduro", "Maduro", "SobreMaduro"))

```

### Tabla descriptiva
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estad <- summarySE(data, measurevar="PFF", groupvars=c("MADUREZ"))
estad

```

### Gráfico con desvío estándar
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(ggplot2)
ggplot(estad, aes(x=MADUREZ, y=PFF, color=MADUREZ)) +
  scale_color_manual(values=c("palegreen4","yellowgreen","gold","gold4"))+
  stat_summary(fun = "mean", size = 6, geom = "point") +
  geom_errorbar(aes(ymin=PFF-sd, ymax=PFF+sd),
                width=.2, position=position_dodge(.9)) +  
  ylab("PFF")+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )+
  ylim(0,80)

```

### Boxplot
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

graf1<- ggplot(data, aes(MADUREZ, PFF, fill=MADUREZ)) +  
  geom_boxplot()+labs(y="PFF")+
  scale_fill_manual(values=c("palegreen4","yellowgreen","gold","gold4"))+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )+
  ylim(0,80)
graf1

```

### Relacion media-varianza
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

estad$var=estad$sd^2#agrego varianza
vs<-ggplot(estad, aes(x=PFF, y=var))+geom_point(size=4) +   
  geom_smooth(method="lm", se = FALSE, color="red", linetype="dashed") + xlab("Media") +
  ylab("Varianza") +  ggtitle("Relaci?n media - varianza")+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )
vs

```

### Modelos

* M0: modelo sólo con el factor fijo madurez.
* M1: M0 + modelado de la varinza por varIdent
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

M0<- lm(PFF ~ MADUREZ ,data)

library(nlme)
M1 <- gls(PFF ~ MADUREZ, weights=varIdent(form=~1|MADUREZ), data = data)

```

### Eleccción de modelos por AIC
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

AIC(M0, M1)

```
Se elije el modelo M1

### Verificación de supuestos
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

e<-resid(M1) # residuos
rest <- resid(M1, type="normalized") #residuos estandarizados
pre<-predict(M1) #predichos

par(mfrow = c(1, 2))
plot(pre, rest, xlab="Predichos", ylab="Residuos estandarizados",main="Gráfico de dispersión de RE vs PRED" )
abline(0,0)
qqnorm(e)
qqline(e)
shapiro.test(e)
par(mfrow = c(1, 1))
library(car)
leveneTest(PFF~MADUREZ, data, center=mean)

```

### Anova
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(M1)

```

### Comparaciones a posteriori
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Comp2<-emmeans(M0, pairwise ~ MADUREZ) #Tukey por default  
Comp2
plot(Comp2, comparisons = TRUE) + theme_classic() + 
  labs(x = "Peso (g)", y ="Madurez" )

```

## Peso seco de fruto (PSF)

### Tabla descriptiva
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estad <- summarySE(data, measurevar="PSF", groupvars=c("MADUREZ"))
estad

```

### Gráfico con desvío estándar
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(ggplot2)
ggplot(estad, aes(x=MADUREZ, y=PSF, color=MADUREZ)) +
  scale_color_manual(values=c("palegreen4","yellowgreen","gold","gold4"))+
  stat_summary(fun = "mean", size = 6, geom = "point") +
  geom_errorbar(aes(ymin=PSF-sd, ymax=PSF+sd),
  width=.2,                    # Width of the error bars
  position=position_dodge(.9)) +  
  ylab("PSF")+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )+
  ylim(0,13)

```

### Boxplot
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

graf2<- ggplot(data, aes(MADUREZ, PSF, fill=MADUREZ)) +  
  geom_boxplot()+labs(y="PSF")+
  scale_fill_manual(values=c("palegreen4","yellowgreen","gold","gold4"))+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )+
  ylim(0,13)
graf2

```

### Relacion media-varianza
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

estad$var=estad$sd^2#agrego varianza
vs<-ggplot(estad, aes(x=PSF, y=var))+geom_point(size=4) +   
  geom_smooth(method="lm", se = FALSE, color="red", linetype="dashed") + xlab("Media") +
  ylab("Varianza") +  ggtitle("Relaci?n media - varianza")+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )
vs

```

### Modelos

* M0s: modelo sólo con el factor fijo madurez.
* M1s: M0 + modelado de la varinza por varIdent
* M1si: M1 con variable respuesta inversa (1/Y)
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
# MODELOS
M0s<- lm(PSF ~ MADUREZ ,data)
library(nlme)
M1s <- gls(PSF ~ MADUREZ, weights=varIdent(form=~1|MADUREZ), data = data)
M1si <- gls(1/PSF ~ MADUREZ, weights=varIdent(form=~1|MADUREZ), data = data)

```

```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

AIC(M0s, M1s, M1si)

```

Se elije el modelo M1si

### Verificación de supuestos
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

e<-resid(M1si) # residuos
rest <- resid(M1si, type="normalized") #residuos estandarizados
pre<-predict(M1si) #predichos

par(mfrow = c(1, 2))
plot(pre, rest, xlab="Predichos", ylab="Residuos estandarizados",main="Gráfico de dispersión de RE vs PRED" )
abline(0,0)
qqnorm(e)
qqline(e)
shapiro.test(e)
par(mfrow = c(1, 1))
library(car)
leveneTest(PSF~MADUREZ, data, center=mean)

```

### Anova
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(M1si)

```

### Comparaciones a posteriori
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
Comp2<-emmeans(M1si, pairwise ~ MADUREZ) #Tukey por default  
Comp2
plot(Comp2, comparisons = TRUE)

```

## Humedad

### Tabla descriptiva
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(Rmisc)
estadH <- summarySE(data, measurevar="H", groupvars=c("MADUREZ"))
estadH

```

### Gráfico con desvío estándar
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(ggplot2)
ggplot(estadH, aes(x=MADUREZ, y=H, color=MADUREZ)) +
  scale_color_manual(values=c("palegreen4","yellowgreen","gold","gold4"))+
  stat_summary(fun = "mean", size = 6, geom = "point") +
  geom_errorbar(aes(ymin=H-sd, ymax=H+sd),
  width=.2,                    # Width of the error bars
  position=position_dodge(.9)) +  
  ylab("Humidity (/100)")+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )+
  ylim(0.5,1)

```

### Boxplot
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

graf2<- ggplot(data, aes(MADUREZ, H, fill=MADUREZ)) +  
  geom_boxplot()+labs(y="Humiity")+
  scale_fill_manual(values=c("palegreen4","yellowgreen","gold","gold4"))+
  theme_classic()+
  theme(legend.title=element_blank())+
  theme(legend.position = "none" )+
  ylim(0.5,1)
graf2

```

### Relacion media-varianza
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

# estadH$var=estadH$sd^2#agrego varianza
# vs<-ggplot(estadH, aes(x=H, y=var))+geom_point(size=4) +   
#   geom_smooth(method="lm", se = FALSE, color="red", linetype="dashed") + xlab("Media") +
#   ylab("Varianza") +  ggtitle("Relación media - varianza")+
#   theme_classic()+
#   theme(legend.title=element_blank())+
#   theme(legend.position = "none" )
# vs

```

### Modelos

* M0s: modelo sólo con el factor fijo madurez.
* M1s: M0 + modelado de la varinza por varIdent
* M1si: M1 con variable respuesta inversa (1/Y)
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
# MODELOS
M0sH<- lm(H ~ MADUREZ ,data)
M0sH
```

```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

# AIC(M0s, M1s, M1si)

```

Se elije el modelo M0sH

### Verificación de supuestos
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

e<-resid(M0sH) # residuos
rest <- resid(M0sH, type="response") #residuos estandarizados
pre<-predict(M0sH) #predichos

par(mfrow = c(1, 2))
plot(pre, rest, xlab="Predichos", ylab="Residuos estandarizados",main="Gráfico de dispersión de RE vs PRED" )
abline(0,0)
qqnorm(e)
qqline(e)
shapiro.test(e)
par(mfrow = c(1, 1))
library(car)
leveneTest(H~MADUREZ, data, center=mean)

```

### Anova
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

anova(M0sH)

```

### Comparaciones a posteriori
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(emmeans)
library(multcompView)
emm_options(opt.digits = FALSE)
Comp2H<-emmeans(M0sH, pairwise ~ MADUREZ) #Tukey por default  
Comp2H
plot(Comp2H, comparisons = TRUE)

```

## Diámetro

## Peso seco semilla

## Tabla resumen
```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}

library(png)
library(grid)
img <- readPNG("varfis.png")
grid.raster(img)
```

ANOVA for the fresh fruit weight (FFW). dry fruit weight (DFW). dry fruit weight as percentage of fresh fruit weight (DFW%). maximum equatorial fruit diameter (MAEFD). minimum equatorial fruit diameter (MIEFD). polar fruit diameter (PFD). seed number (SN). dry seed weight (DSW) and dry seed weight/dry fruit weight ratio (DSW/DFW) considering the fruit ripening of H. edulis "ubajay" harvested from the plants growing in the experimental field of the University of Morón in Moreno (Buenos Aires) during December 2018.

## Colorimetría

```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
# #setwd("C:/Users/um/Documents/ipovilonis/Doc/6 - Producción/web/ipovilonis.github.io")
library(readxl)
data<-read_excel("database.xlsx", sheet="mad_color")
data$MADUREZ<-factor(data$MADUREZ,levels=c("Inmaduro", "Medio Maduro", "Maduro", "SobreMaduro"))

```


### Descriptive table color_L
```{r  , echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(dplyr)
table_color_L<- data %>%
  dplyr::group_by(MADUREZ) %>%
  dplyr::summarise(
    Mean = mean(color_L),
    min = min(color_L),
    max = max(color_L),
    sd = sd(color_L)
  )


table_color_L

```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
library(ggplot2)
gg_mad_color_L<-ggplot(table_color_L, aes(x=MADUREZ, y=(Mean), color=MADUREZ, fill=MADUREZ)) + 
  geom_bar(stat="identity", size=.05, color="black") +
  labs(y="", x= "")+
  geom_errorbar(aes(ymin=Mean-sd, ymax=Mean+sd),width=.05, color="black")+
  theme_classic() +
  theme(
    legend.position = "bottom",
    legend.background = element_rect(fill = "white"),
    legend.title = element_blank(),
    panel.grid.major.y = element_line(size = 0.05, color = 'black'),
    panel.grid.major.x = element_blank(),
    text = element_text(size = 20, color = 'black'),
    plot.background = element_rect(fill = "white"),
    panel.background = element_rect(fill = "white", color = "white"),
    panel.border = element_rect(fill = "transparent"),
    axis.text.x = element_blank(),
    axis.text.y = element_text(angle = 0, hjust = 1, color = 'black')
  )+
  scale_color_manual(values = c("palegreen4","yellowgreen","gold","gold4"))+
  scale_fill_manual(values = c("palegreen4","yellowgreen","gold","gold4"))+
  # scale_y_continuous(breaks=seq(0, 50, 5))+
  geom_text(aes(label = round(Mean,2)), vjust = -0.5, hjust = -0.1, size=5)+
  theme(axis.text.y = element_text(angle = 0, hjust = 1, color='black'))+
  scale_y_continuous(breaks = seq(0,90, 30), limits = c(0, 90))

gg_mad_color_L
```

```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)



```

```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)



```

```{r, echo=FALSE, error=TRUE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)



```

### Descriptive table color_a
```{r  , echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(dplyr)
table_color_a<- data %>%
  dplyr::group_by(MADUREZ) %>%
  dplyr::summarise(
    Mean = mean(color_a),
    min = min(color_a),
    max = max(color_a),
    sd = sd(color_a)
  )

table_color_a

```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
library(ggplot2)
gg_mad_color_a<-ggplot(table_color_a, aes(x=MADUREZ, y=(Mean), color=MADUREZ, fill=MADUREZ)) + 
  geom_bar(stat="identity", size=.05, color="black") +
  labs(y="", x= "")+
  geom_errorbar(aes(ymin=Mean-sd, ymax=Mean+sd),width=.05, color="black")+
  theme_classic() +
  theme(
    legend.position = "bottom",
    legend.background = element_rect(fill = "white"),
    legend.title = element_blank(),
    panel.grid.major.y = element_line(size = 0.05, color = 'black'),
    panel.grid.major.x = element_blank(),
    text = element_text(size = 20, color = 'black'),
    plot.background = element_rect(fill = "white"),
    panel.background = element_rect(fill = "white", color = "white"),
    panel.border = element_rect(fill = "transparent"),
    axis.text.x = element_blank(),
    axis.text.y = element_text(angle = 0, hjust = 1, color = 'black')
  )+
  scale_color_manual(values = c("palegreen4","yellowgreen","gold","gold4"))+
  scale_fill_manual(values = c("palegreen4","yellowgreen","gold","gold4"))+
  # scale_y_continuous(breaks=seq(0, 50, 5))+
  geom_text(aes(label = round(Mean,2)), vjust = -0.5, hjust = -0.1, size=5)+
  theme(axis.text.y = element_text(angle = 0, hjust = 1, color='black'))+
  scale_y_continuous(breaks = seq(0,10, 2), limits = c(0, 10))

gg_mad_color_a
```

### Descriptive table color_b
```{r  , echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

library(dplyr)
table_color_b<- data %>%
  dplyr::group_by(MADUREZ) %>%
  dplyr::summarise(
    Mean = mean(color_b),
    min = min(color_b),
    max = max(color_b),
    sd = sd(color_b)
  )

table_color_b

```

```{r, echo=FALSE, fig.align='center', fig.asp=0.4, fig.width=10, fig.height=8}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
library(ggplot2)
gg_mad_color_b<-ggplot(table_color_b, aes(x=MADUREZ, y=(Mean), color=MADUREZ, fill=MADUREZ)) + 
  geom_bar(stat="identity", size=.05, color="black") +
  labs(y="", x= "")+
  geom_errorbar(aes(ymin=Mean-sd, ymax=Mean+sd),width=.05, color="black")+
  theme_classic() +
  theme(
    legend.position = "bottom",
    legend.background = element_rect(fill = "white"),
    legend.title = element_blank(),
    panel.grid.major.y = element_line(size = 0.05, color = 'black'),
    panel.grid.major.x = element_blank(),
    text = element_text(size = 20, color = 'black'),
    plot.background = element_rect(fill = "white"),
    panel.background = element_rect(fill = "white", color = "white"),
    panel.border = element_rect(fill = "transparent"),
    axis.text.x = element_blank(),
    axis.text.y = element_text(angle = 0, hjust = 1, color = 'black')
  )+
  scale_color_manual(values = c("palegreen4","yellowgreen","gold","gold4"))+
  scale_fill_manual(values = c("palegreen4","yellowgreen","gold","gold4"))+
  # scale_y_continuous(breaks=seq(0, 50, 5))+
  geom_text(aes(label = round(Mean,2)), vjust = -0.5, hjust = -0.1, size=5)+
  theme(axis.text.y = element_text(angle = 0, hjust = 1, color='black'))+
  scale_y_continuous(breaks = seq(0,20, 2), limits = c(0, 14))

gg_mad_color_b
```